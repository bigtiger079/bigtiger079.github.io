<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <meta http-equiv="X-UA-Compatible" content="IE=edge" >
  <title>C++中的模板 | Bigtiger&#39;s blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="模板
模板把函数或类要处理的数据类型参数化, 表现为参数的多态性, 称为类属.
模板用于表达逻辑结构相同, 但具体数据类型不同的数据对象的通用行为.">
<meta property="og:type" content="article">
<meta property="og:title" content="C++中的模板">
<meta property="og:url" content="http://www.bigtiger079.com/2015/09/22/C-中的模板/index.html">
<meta property="og:site_name" content="Bigtiger's blog">
<meta property="og:description" content="模板
模板把函数或类要处理的数据类型参数化, 表现为参数的多态性, 称为类属.
模板用于表达逻辑结构相同, 但具体数据类型不同的数据对象的通用行为.">
<meta property="og:updated_time" content="2016-01-29T02:43:57.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="C++中的模板">
<meta name="twitter:description" content="模板
模板把函数或类要处理的数据类型参数化, 表现为参数的多态性, 称为类属.
模板用于表达逻辑结构相同, 但具体数据类型不同的数据对象的通用行为.">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link rel="stylesheet" href="/css/style.css" type="text/css">
</head>

<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img lazy-src="http://7xlrpi.com1.z0.glb.clouddn.com/avatar.png" class="js-avatar">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/">Bigtiger</a></h1>
		</hgroup>

		

		
			<div class="switch-btn">
				<div class="icon">
					<div class="icon-ctn">
						<div class="icon-wrap icon-house" data-idx="0">
							<div class="birdhouse"></div>
							<div class="birdhouse_holes"></div>
						</div>
						<div class="icon-wrap icon-ribbon hide" data-idx="1">
							<div class="ribbon"></div>
						</div>
						
						
						<div class="icon-wrap icon-me hide" data-idx="3">
							<div class="user"></div>
							<div class="shoulder"></div>
						</div>
						
					</div>
					
				</div>
				<div class="tips-box hide">
					<div class="tips-arrow"></div>
					<ul class="tips-inner">
						<li>菜单</li>
						<li>标签</li>
						
						
						<li>关于我</li>
						
					</ul>
				</div>
			</div>
		

		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/">主页</a></li>
				        
							<li><a href="/archives">所有文章</a></li>
				        
							<li><a href="/categories">分类</a></li>
				        
							<li><a href="/tags">标签</a></li>
				        
						</ul>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
								<a class="mail" target="_blank" href="/bigtiger079@gmail.com" title="mail">mail</a>
					        
						</div>
					</nav>
				</section>
				
				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud" id="js-tagcloud">
						<a href="/tags/Android/" style="font-size: 10px;">Android</a> <a href="/tags/C/" style="font-size: 10px;">C++</a> <a href="/tags/Cpp基础/" style="font-size: 10px;">Cpp基础</a> <a href="/tags/Hexo/" style="font-size: 10px;">Hexo</a> <a href="/tags/JNI/" style="font-size: 10px;">JNI</a> <a href="/tags/RecyclerView/" style="font-size: 16.67px;">RecyclerView</a> <a href="/tags/android/" style="font-size: 10px;">android</a> <a href="/tags/linux/" style="font-size: 20px;">linux</a> <a href="/tags/线性表/" style="font-size: 13.33px;">线性表</a>
					</div>
				</section>
				
				
				

				
				
				<section class="switch-part switch-part3">
				
					<div id="js-aboutme">我是谁，我从哪里来，我到哪里去？我就是我，是颜色不一样的吃货…</div>
				</section>
				
			</div>
		</div>
	</header>				
</div>

    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide">Bigtiger</h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
			
				<img lazy-src="http://7xlrpi.com1.z0.glb.clouddn.com/avatar.png" class="js-avatar">
			
			</div>
			<hgroup>
			  <h1 class="header-author">Bigtiger</h1>
			</hgroup>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">主页</a></li>
		        
					<li><a href="/archives">所有文章</a></li>
		        
					<li><a href="/categories">分类</a></li>
		        
					<li><a href="/tags">标签</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
						<a class="mail" target="_blank" href="/bigtiger079@gmail.com" title="mail">mail</a>
			        
				</div>
			</nav>
		</header>				
	</div>
</nav>

      <div class="body-wrap"><article id="post-C-中的模板" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/09/22/C-中的模板/" class="article-date">
  	<time datetime="2015-09-22T03:52:00.000Z" itemprop="datePublished">2015-09-22</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      C++中的模板
    </h1>
  

      </header>
      
      <div class="article-info article-info-post">
        
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Cpp基础/">Cpp基础</a></li></ul>
	</div>

        
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/C/">C++</a>
	</div>


        <div class="clearfix"></div>
      </div>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="u6A21_u677F"><a href="#u6A21_u677F" class="headerlink" title="模板"></a>模板</h2><blockquote>
<p>模板把函数或类要处理的数据类型参数化, 表现为参数的多态性, 称为类属.</p>
<p>模板用于表达逻辑结构相同, 但具体数据类型不同的数据对象的通用行为.</p>
</blockquote>
<a id="more"></a>
<h3 id="u4EC0_u4E48_u662F_u6A21_u677F"><a href="#u4EC0_u4E48_u662F_u6A21_u677F" class="headerlink" title="什么是模板"></a>什么是模板</h3><p>类属– 类型参数化, 又称参数模板</p>
<p>使得程序(算法)可以从逻辑功能上抽象, 把被处理的对象(数据)类型作为参数传递</p>
<p>C++ 提供两种模板机制: 函数模板    、类模板</p>
<h3 id="u51FD_u6570_u6A21_u677F"><a href="#u51FD_u6570_u6A21_u677F" class="headerlink" title="函数模板"></a>函数模板</h3><p>考虑求两参数之中大值函数：max(a,b), 对a,b的不同类型都有相同的处理形式:<br></p>
<pre><code>return (a&gt;b)? a:b;
</code></pre><p>用已有方法解决对不同数据类型处理:<br><br>(1)宏替换 </p>
<pre><code>#define max(a,b)(a&gt;b? a:b)
</code></pre><blockquote>
<p>问题  避开类型检查 </p>
</blockquote>
<p>(2)重载</p>
<blockquote>
<p>问题  需要许多重载版本</p>
</blockquote>
<p>(3)使用模板函数</p>
<h4 id="u6A21_u677F_u8BF4_u660E"><a href="#u6A21_u677F_u8BF4_u660E" class="headerlink" title="模板说明"></a>模板说明</h4><p>声明模板中使用的类属参数.形式为:</p>
<pre><code>template&lt;类型形式参数表&gt;
</code></pre><p>类型形式参数的形式为:</p>
<pre><code>typename T1, typename T2, ....., typename Tn
或:    
class T1, class T2, ....., class Tn
</code></pre><p>例如:</p>
<pre><code>template&lt;typename T&gt;
template&lt;typename ElementType&gt;
template&lt;typename NameType, typename DataType&gt;
</code></pre><h4 id="u51FD_u6570_u6A21_u677F_u4E0E_u6A21_u677F_u51FD_u6570"><a href="#u51FD_u6570_u6A21_u677F_u4E0E_u6A21_u677F_u51FD_u6570" class="headerlink" title="函数模板与模板函数"></a>函数模板与模板函数</h4><p>函数模板声明:</p>
<pre><code>template &lt;类型形式参数&gt;
类型  函数名(形式参数表)
{
    语句序列
}
</code></pre><blockquote>
<p>函数模板定义由模板说明核函数定义组成</p>
<p>模板书名的类属参数必须在函数定义中至少出现一次</p>
<p>函数参数表中可以使用类属类型参数, 也可以使用一般类型参数</p>
</blockquote>
<h3 id="u91CD_u8F7D_u51FD_u6570_u6A21_u677F"><a href="#u91CD_u8F7D_u51FD_u6570_u6A21_u677F" class="headerlink" title="重载函数模板"></a>重载函数模板</h3><p>有些特殊情况需要函数模板参与重载</p>
<p>例如:</p>
<pre><code>template &lt;typename T&gt;
T max(T a, T b)
{
    return a&gt;b? a:b;
}

void f(int i, cahr c)
{
    max(i, i);    //OK
    max(c, c);    //OK
    max(i, c);    //error, 无法匹配
    max(c, i);    //error
}
</code></pre><p>重载:</p>
<pre><code>template &lt;typename T&gt;
T max(T a, T b)
{
    return a&gt;b? a:b;
}

int max(int a, int b)    //模板函数重载版本
{
    return a&gt;b? a:b
}

void f(int i, cahr c)
{ 
    max(i, i);    //OK
    max(c, c);    //OK
    max(i, c);    //ok, 由系统提供隐式转换
    max(c, i);    //ok
}
</code></pre><p>匹配约定</p>
<blockquote>
<p>寻找和使用最符合函数名和函数参数类型的函数, 若找到则调用它;</p>
<p>否则,寻找一盒函数模板, 梨花产生一个匹配的模板函数, 若找到则调用它;</p>
<p>否则, 寻找可以通过类型转换进行参数匹配的重载函数, 若找到则调用它</p>
<p>如果按以上步骤均未能找到匹配函数, 则调用错误.</p>
<p>如果调用有多余一个的匹配选择, 则调用匹配出现二义性.</p>
</blockquote>
<ul>
<li>函数模板可以向普通函数一样被重载</li>
<li>C++编译器优先考虑普通函数</li>
<li>如果函数模板可以产生一个更好的匹配, 那么选择模板</li>
<li>可以通过空模板参数列表的语法限定编译器只有通过模板匹配  </li>
</ul>
<p>函数模板的深入理解</p>
<blockquote>
<p>编译器并不是把函数模板处理成能够处理任意类型的函数</p>
<p>编译器从函数模板通过具体类型产生不同的函数</p>
<p>编译器会对函数模板进行两次编译</p>
<p>在声明的地方对模板代码本身进行编译</p>
<p>在调用的地方对函数参数替换后的代码进行编译 </p>
</blockquote>
<h3 id="u7C7B_u6A21_u677F"><a href="#u7C7B_u6A21_u677F" class="headerlink" title="类模板"></a>类模板</h3><p>类模板用于实现类所需数据的类型参数化</p>
<p>类模板在表示如数组、表、图等数据结构咸的特别重要,这些数据结构的表示和算法不收所包含的元素类型影响</p>
<h4 id="u7C7B_u6A21_u677F_u4E0E_u6A21_u677F_u7C7B"><a href="#u7C7B_u6A21_u677F_u4E0E_u6A21_u677F_u7C7B" class="headerlink" title="类模板与模板类"></a>类模板与模板类</h4><p>类模板有模板书名和类说明构成</p>
<pre><code>template&lt;类型形式参数表&gt;
类声明
</code></pre><p>例如:</p>
<pre><code>template&lt;typename Type&gt;
class TClass
{
    //TClass的成员函数
    private:
        Type DateMember;    //类属参数必须至少在类说明中出现一次
    //...
};
</code></pre><p>一个数组类模板</p>
<pre><code>template&lt;typename T&gt;
class Array
{
    public:
        Array(int s);
        virtual ~array();
        virtual const T&amp; Entry(int index) const;
        virtual void Enter(int index, const T&amp; value);
    protected:
        int size;
        T* element;
}
template&lt;typename T&gt; Array&lt;T&gt;::Array(int s)
{
    if(s＞１)
    {
        ｓｉｚｅ　＝ｓ；
    } else
    {
        ｓｉｚｅ　＝１；
    }
    element = new T[size];
}
template&lt;typename T&gt; Array&lt;T&gt;:: ~Array()
{
    delete[] element;
}
template&lt;typename T&gt; const T&amp; Array&lt;T&gt;::Entry(int index)const
{
    return element[index]; 
}
template&lt;typename T&gt; void Array&lt;T&gt;::Enter(int index, const T&amp; value)
{
    element[index] = value;
}
</code></pre><h4 id="u5728_u7C7B_u5C42_u6B21_u4E2D_u7684_u7C7B_u6A21_u677F"><a href="#u5728_u7C7B_u5C42_u6B21_u4E2D_u7684_u7C7B_u6A21_u677F" class="headerlink" title="在类层次中的类模板"></a>在类层次中的类模板</h4><p>一个类模板在类层次结构中既可以是基类也可以是派生类:</p>
<blockquote>
<p>类模板可以从模板类派生</p>
<p>类模板可以从非模板类派生</p>
<p>模板类可以从类模板派生</p>
<p>非模板类可以从类模板派生    </p>
<p>类模板派生普通类, 在定义派生类是要对基类的抽象参数实例化</p>
<p>从普通类派生模板类, 意味着派生类添加了抽象类数据成员</p>
</blockquote>
<p>从类模板A派生普通类B</p>
<pre><code>#include&lt;iostream.h&gt;
template&lt;typename T&gt;        //定义类模板
class A
{
    public:
        A(T x)
        {
            t = x;
        }
        void out()
        {
            cout&lt;&lt; t &lt;&lt; endl;
        }
    protected:
        T t;
}
</code></pre><p>B:</p>
<pre><code>class B:public A&lt;int&gt;
{
    public:
        B(int a, double x):A&lt;int&gt;(a)        //子类调用父类的构造函数
        {
            y = x;
        }
        void out()
        {
            A&lt;int&gt;::out;
            cout&lt;&lt; y &lt;&lt; endl:
        }
    protected:
        double y;
}
</code></pre><h3 id="u7C7B_u6A21_u677F_u9047_u4E0A_u53CB_u5143_u51FD_u6570"><a href="#u7C7B_u6A21_u677F_u9047_u4E0A_u53CB_u5143_u51FD_u6570" class="headerlink" title="类模板遇上友元函数"></a>类模板遇上友元函数</h3><p>为复数类模板用定义重载运算符友元函数</p>
<pre><code>#inclde&lt;iostream.h&gt;
template&lt;typename T&gt;
class Complex
{
    public:
        Complex(T r = 0, T i = 0);
        Complex(T a)
        {
            Real = a;
            Image = 0;
        }
        void print() const;
        friend Complex operator+ (const Complex&lt;T&gt; &amp; c1, const Complex&lt;T&gt; &amp; c2)
        {
            T r = c1.Real +ｃ２．Ｒｅａｌ；
            T i = c1.Image + c2.Image;
            return Complex&lt;T&gt;(r, i); 
        }
        friend Complex operator- (const Complex&lt;T&gt; &amp; c1, const Complex&lt;T&gt; &amp; c2);
        {
            T r = c1.Real -ｃ２．Ｒｅａｌ；
            T i = c1.Image - c2.Image;
            return Complex&lt;T&gt;(r, i); 
        }
        friend Complex operator- (const Complex&lt;T&gt; &amp; c1)
        {
            return Complex&lt;T&gt;(-cReal, -c.Image); 
        }
    private:
        T Real, Image;
};


template&lt;typename T&gt; Complex&lt;T&gt;::Complex(T r, T i)
{
    Real = r;
    Image = i;
}

template&lt;typename T&gt; void Completx&lt;T&gt;::print()const
{
    cout &lt;&lt; &apos;(&apos;&lt;&lt; Real &lt;&lt; &quot;,&quot; &lt;&lt; Image &lt;&lt; &apos;)&apos; &lt;&lt;endl;
}

void main()
{
    Complex&lt;double&gt; c1(2.5, 3.7), c2(4.2, 6.5);
    Complex&lt;double&gt; c;
    c = c1 - c2;
    c.print();
    c = c1 + c2;
    c.print();
    c =- c1/;
    c.print();
}
</code></pre><h3 id="u7C7B_u6A21_u677F_u4E0Estatic_u6210_u5458"><a href="#u7C7B_u6A21_u677F_u4E0Estatic_u6210_u5458" class="headerlink" title="类模板与static成员"></a>类模板与static成员</h3><blockquote>
<p>从类模板实例化的每个模板类有自己的类模板数据成员, 该模板类的所有对象共享一个static数据成员</p>
<p>和非模板类的static数据成员一样, 模板类的static数据成员也应该在文件范围定义和初始化</p>
<p>每个模板类有自己的类模板的static数据成员副本</p>
</blockquote>

      
    </div>
    
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2015/09/22/STL入门/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption"><</strong>
      <div class="article-nav-title">
        
          STL入门
        
      </div>
    </a>
  
  
    <a href="/2015/09/16/Android中使用软键盘/" id="article-nav-older" class="article-nav-link-wrap">
      <div class="article-nav-title">Android中使用软键盘</div>
      <strong class="article-nav-caption">></strong>
    </a>
  
</nav>

  
</article>


<div class="share_jia">
	<!-- JiaThis Button BEGIN -->
	<div class="jiathis_style">
		<span class="jiathis_txt">分享到: &nbsp; </span>
		<a class="jiathis_button_facebook"></a> 
    <a class="jiathis_button_twitter"></a>
    <a class="jiathis_button_plus"></a> 
    <a class="jiathis_button_tsina"></a>
		<a class="jiathis_button_cqq"></a>
		<a class="jiathis_button_douban"></a>
		<a class="jiathis_button_weixin"></a>
		<a class="jiathis_button_tumblr"></a>
    <a href="http://www.jiathis.com/share" class="jiathis jiathis_txt jtico jtico_jiathis" target="_blank"></a>
	</div>
	<script type="text/javascript" src="http://v3.jiathis.com/code/jia.js?uid=1405949716054953" charset="utf-8"></script>
	<!-- JiaThis Button END -->
</div>






<div class="duoshuo">
	<!-- 多说评论框 start -->
	<div class="ds-thread" data-thread-key="C-中的模板" data-title="C++中的模板" data-url="http://www.bigtiger079.com/2015/09/22/C-中的模板/"></div>
	<!-- 多说评论框 end -->
	<!-- 多说公共JS代码 start (一个网页只需插入一次) -->
	<script type="text/javascript">
	var duoshuoQuery = {short_name:"true"};
	(function() {
		var ds = document.createElement('script');
		ds.type = 'text/javascript';ds.async = true;
		ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
		ds.charset = 'UTF-8';
		(document.getElementsByTagName('head')[0] 
		 || document.getElementsByTagName('body')[0]).appendChild(ds);
	})();
	</script>
	<!-- 多说公共JS代码 end -->
</div>




</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
    	<div class="footer-left">
    		&copy; 2016 Bigtiger
    	</div>
      	<div class="footer-right">
      		<a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/litten/hexo-theme-yilia" target="_blank">Yilia</a> by Litten
      	</div>
    </div>
  </div>
</footer>
    </div>
    
  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">


<script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: true,
		animate: true,
		isHome: false,
		isPost: true,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false
	}
</script>
<script src="http://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js" type="text/javascript"></script>
<script src="/js/main.js" type="text/javascript"></script>






<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


  </div>
</body>
</html>